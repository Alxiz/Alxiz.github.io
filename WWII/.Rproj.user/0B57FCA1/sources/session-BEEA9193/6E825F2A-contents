#
# This is a Shiny web application. You can run the application by clicking
# the 'Run App' button above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#


library(readr)
library(shiny)
library(ggplot2)
library(dplyr)  # Load the dplyr library for data manipulation

casualty_data <- read_csv("ww2_dataset.csv")

ui <- fluidPage(
  titlePanel("WW2 Casualties by Country"),
  mainPanel(
    plotOutput("barplot")
  )
)

server <- function(input, output) {
  # Check if the "Country" column exists in the dataset
  if ("Country" %in% colnames(casualty_data)) {
    # Define a vector of important countries
    important_countries <- c("USA", "Germany", "Japan", "United Kingdom", "Soviet Union", "Italy", "France", "China", "Poland")
    
    # Filter the data to include only the important countries
    filtered_data <- filter(casualty_data, Country %in% important_countries)
    
    output$barplot <- renderPlot({
      ggplot(data = filtered_data, aes(x = Country, y = Totaldeaths)) +
        geom_bar(stat = "identity", fill = "maroon") +
        labs(x = "Country", y = "Casualties") +
        theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
        ggtitle("WW2 Casualties by Country (Important Countries)")
    })
  } else {
    # If the "Country" column doesn't exist, display an error message
    output$barplot <- renderText("The 'Country' column does not exist in the dataset.")
  }
}

# Run the application 
shinyApp(ui = ui, server = server)